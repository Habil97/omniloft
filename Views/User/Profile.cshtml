@model Verveo.Entities.User
@{
    ViewData["Title"] = "Hesabım";
}
<div class="container py-5 d-flex justify-content-center align-items-start gap-4" style="min-height: 70vh;">
    <div class="card shadow-lg p-4" style="max-width: 400px; width: 100%;">
        <div class="text-center mb-4">
            <h2 class="mt-2">Hesabım</h2>
        </div>
        <div class="mb-3">
            <label class="form-label">Ad Soyad</label>
            <div class="form-control bg-light">@Model.Username</div>
        </div>
        <div class="mb-3">
            <label class="form-label">Email</label>
            <div class="form-control bg-light">@Model.Email</div>
        </div>
        <a href="/User/Logout" class="btn w-100 px-4 py-2 fw-bold mb-3"
           style="text-decoration:none;box-shadow:0 2px 8px rgba(0,0,0,0.08);border-radius:2rem;background:linear-gradient(90deg,#e96443 0%,#904e95 100%);color:#fff;border:none;">
            Çıkış Yap
        </a>
        <form asp-action="ResetPassword" method="post" class="mb-3">
            <label class="form-label">Parola Sıfırla</label>
            <input type="email" name="email" placeholder="E-posta" required class="form-control mb-2" />
            <input type="password" name="newPassword" placeholder="Yeni Parola" required class="form-control mb-2" />
            <button type="submit" class="btn btn-primary w-100">Parolayı Sıfırla</button>
        </form>
        @if (ViewBag.Message != null)
        {
            <div class="alert alert-success mt-2">@ViewBag.Message</div>
        }
        <form asp-action="Delete" method="post" class="mt-2">
            <input type="hidden" name="id" value="@Model.Id" />
            <button type="submit" class="btn w-100 px-4 py-2 fw-bold"
                    style="text-decoration:none;box-shadow:0 2px 8px rgba(0,0,0,0.08);border-radius:2rem;background:linear-gradient(90deg,#e96443 0%,#904e95 100%);color:#fff;border:none;"
                    onclick="return confirm('Hesabınızı silmek istediğinize emin misiniz?');">
                Hesabı Sil
            </button>
        </form>
    </div>

    <div class="card shadow-lg p-4 mt-4" style="max-width: 700px; width: 100%;">
        <h4 class="mb-3">Yorumlarım</h4>
        @if (Model.Reviews != null && Model.Reviews.Any())
        {
            <table class="table">
                <thead>
                    <tr>
                        <th>Ürün</th>
                        <th>Puan</th>
                        <th>Yorum</th>
                        <th>Tarih</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var review in Model.Reviews)
                    {
                        <tr>
                            <td>@review.Product?.Name</td>
                            <td>@review.Rating</td>
                            <td>@review.Comment</td>
                            <td>@review.CreatedAt.ToShortDateString()</td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <div class="alert alert-info">Henüz yorumunuz yok.</div>
        }

        <!-- Favori Ürünlerim Bölümü -->
        <div class="mt-5">
            <h4 class="mb-3">Favori Ürünlerim</h4>
            @if (Model.FavoriteProducts != null && Model.FavoriteProducts.Any())
            {
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>Ürün</th>
                                <th>Fiyat</th>
                                <th style="width:220px;">İşlem</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var fav in Model.FavoriteProducts)
                            {
                                <tr>
                                    <td>@fav.Product?.Name</td>
                                    <td>@fav.Product?.Price.ToString("C")</td>
                                    <td>
                                        <div class="d-flex gap-2">
                                            <form asp-action="RemoveFavorite" asp-route-productId="@fav.ProductId" method="post" class="m-0">
                                                <button type="submit" class="btn btn-outline-danger btn-sm d-flex align-items-center px-3">
                                                    <i class="bi bi-heartbreak me-1"></i> Favorilerden Çıkar
                                                </button>
                                            </form>
                                            <form asp-controller="Cart" asp-action="AddToCart" method="post" class="m-0">
                                                <input type="hidden" name="productId" value="@fav.ProductId" />
                                                <input type="hidden" name="quantity" value="1" />
                                                <button type="submit" class="btn btn-primary btn-sm d-flex align-items-center px-3">
                                                    <i class="bi bi-cart-plus me-1"></i> Sepete Ekle
                                                </button>
                                            </form>
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <div class="alert alert-info">Henüz favori ürününüz yok.</div>
            }
        </div>
    </div>
</div>

<!-- Bootstrap Icons CDN ekle (head kısmına) -->
<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet"> -->
